!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var r=i(1),s=n(r),a=i(7),o=n(a),h=i(10),c=i(11),l=i(12),u=i(17),f=i(18),d=i(20),p=i(21),g=i(22),y=i(23),m=i(24),A=i(25),v=i(26),w=i(27),b=i(28),x=n(b),k=o.default;k.states={title:h.Title,main:l.Main,intro:c.Intro,win:u.Win},k.ents={p1:f.P1,carrot:d.Carrot,text:m.Text,hog:p.Hog,hornet:g.Hornet,bat:y.Bat,boom:A.Boom,bunny:v.Bunny,fade:w.Fade},k.SoundFX=x.default,new s.default(k).init()},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={w:320,h:480,orientation:"portrait"},i=navigator.userAgent.toLowerCase();this.mobile="createTouch"in document||!1,this.android=i.indexOf("android")>-1,this.ios=/ipad|iphone|ipod/.test(i),this.firefox=i.indexOf("firefox")>-1;for(var n in e)this[n]=e[n];return this.options=Object.assign(e,t),this.sfx=t.SoundFX,this.dt=0,this.fps=60,this.frameStep=1/this.fps,this.frameCurr=0,this.framePrev=p.default.timeStamp(),this.stateName="title",this.H=p.default,this.states=t.states,this.availEnts=t.ents,this.score=0,this.hiScore=20,this.plays=0,this.ents=[],this.imgs=[],this.fonts=[],this.events=[],this.transition=!1,this.init=function(){var t=this,e=new a.default(this.options.i);document.title=this.options.title,this.canvas=new h.default(this.options.w,this.options.h),this.draw=new l.default(this.canvas.c,this.canvas.ctx),this.input=new f.default(this.canvas.c,this.g),this.sfx.add(this.options.sfx),e.start().then(function(e){t.imgs=e,t.makeFonts(t.imgs.font),document.getElementById("l").style.display="none",t.changeState(t.stateName),t.canvas.c.style.display="block",t.favIcon(t.draw.resize(t.imgs.carrot,8)),t.loop()})},this.makeFonts=function(t){for(var e=12;e-- >1;)this.imgs["font_"+e]=this.draw.resize(t,e)},this.favIcon=function(t){var e=document.createElement("canvas"),i=e.getContext("2d"),n=document.createElement("link");e.width=e.height=64,i.drawImage(t,0,0),n.type="image/x-icon",n.rel="shortcut icon",n.href=e.toDataURL("image/x-icon"),document.getElementsByTagName("head")[0].appendChild(n)},this.changeState=function(t){this.ents=[],this.events=[],this.state=new this.states[t](this),this.state.init(),this.transition=!1},this.loop=function(){var t=this;for(this.frameCurr=p.default.timeStamp(),this.dt=this.dt+Math.min(1,(this.frameCurr-this.framePrev)/1e3);this.dt>this.frameStep;)this.dt=this.dt-this.frameStep,this.update(this.frameStep);this.render(this.dt),this.framePrev=this.frameCurr,this.input.resetKeys(),requestAnimationFrame(function(){return t.loop()})},this.update=function(t){this.fader=Math.sin(.005*(new Date).getTime()),this.runEvents(t),this.state.update(t);for(var e=this.ents.length;e--;)this.ents[e].remove&&this.ents.splice(e,1);this.input.click=!1,this.transition&&(this.transition.update(),this.transition.done&&this.transition.changeTo&&(this.changeState(this.transition.changeTo),this.transition=null))},this.render=function(t){this.state.render(t),this.transition&&this.transition.render()},this.spawn=function(t,e){var i=new this.availEnts[t](this,e);return this.ents.push(i),i},this.addEvent=function(t){this.events.push(t)},this.runEvents=function(t){for(var e=this.events.length;e--;){var i=this.events[e];if(!i)break;i.time-=100*t,i.time<0&&(i.cb.call(this),this.events.splice(e,1))}},this}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;var s=i(2),a=n(s),o=i(3),h=n(o),c=i(4),l=n(c),u=i(5),f=n(u),d=i(6),p=n(d)},function(t,e){"use strict";function i(t){this.images=t,this.loaded=[],this.loadedImgs=0,this.totalImgs=Object.keys(t).length,this.start=function(){var t=this;return new Promise(function(e,i){t.resolve=e,t.reject=i,t.loadImages(t.images)})},this.loadImages=function(t){for(var e in t)t.hasOwnProperty(e)&&(this.loaded[e]=new Image,this.loaded[e].onload=this.checkLoaded(),this.loaded[e].src="data:image/gif;base64,"+t[e])},this.checkLoaded=function(){var t=this;this.loadedImgs+=1,this.loadedImgs===this.totalImgs&&setTimeout(function(){return t.resolve(t.loaded)},500)},this.makeFonts=function(){var t=this;return new Promise(function(e,i){t.resolve=e,t.reject=i})}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e){"use strict";function i(t,e){var i=this;return this.w=t,this.h=e,this.c=document.getElementsByTagName("canvas")[0],this.ctx=this.c.getContext("2d"),this.c.width=t,this.c.height=e,this.c.style.width=t+"px",this.c.style.height=e+"px",this.resize=function(){var t=window.innerHeight,e=this.w/this.h,i=t*e,n=!window.screenTop&&!window.screenY;this.c.width=this.w,this.c.height=this.h,this.cx=this.w/2,this.cy=this.h/2,this.c.style.width=~~i+"px",this.c.style.height=~~t+"px",n?this.c.classList.add("fullscreen"):this.c.classList.remove("fullscreen")},window.addEventListener("resize",function(){i.resize()}),this.resize(),{c:this.c,ctx:this.ctx}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e){"use strict";function i(t,e){this.c=t,this.ctx=e,this.clear=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#000",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(3===t.length){t="rgba("+(t.join(",")+","+e)+")"}this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.c.width,this.c.height)},this.circle=function(t,e,i,r){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;"object"===(void 0===r?"undefined":n(r))&&(r="rgba("+r[0]+", "+r[1]+", "+r[2]+","+s+")"),this.ctx.fillStyle=r,this.ctx.beginPath(),this.ctx.arc(t,e,i,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},this.rect=function(t,e,i,r,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;"object"===(void 0===s?"undefined":n(s))&&(s="rgba("+s[0]+", "+s[1]+", "+s[2]+","+a+")"),this.ctx.fillStyle=s,this.ctx.fillRect(t,e,i,r,s)},this.img=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n&&(t=this.resize(t,n)),this.ctx.drawImage(t,~~e,~~i)},this.flip=function(t,e,i){var n=this.mkCanvas(t.width,t.height),r=n.getContext("2d"),s=e?-1:1,a=i?-1:1,o=e?t.width*-1:0,h=i?t.height*-1:0;return n.width=t.width,n.height=t.height,r.save(),r.scale(s,a),r.drawImage(t,o,h,t.width,t.height),r.restore(),n},this.resize=function(t,e){var i=this.mkCanvas(t.width*e,t.height*e),n=i.getContext("2d");return i.width&&(n.save(),n.scale(e,e),n.drawImage(t,0,0),n.restore()),i.scale=e,i},this.color=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.mkCanvas(t.width,t.height),r=n.getContext("2d"),s=0,a=new Image,o=void 0;for(r.drawImage(t,0,0),o=r.getImageData(0,0,t.width,t.height),s=0;s<o.data.length;s+=4)o.data[s+0]=e[0],o.data[s+1]=e[1],o.data[s+2]=e[2];return r.putImageData(o,0,0),a.src=n.toDataURL(),i?n:a},this.mkCanvas=function(t,e){var i=document.createElement("canvas"),n=i.getContext("2d");return i.width=t,i.height=e,n.mozImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1,i},this.textWidth=function(t,e){return t.length*(3*e.scale)+t.length*(1*e.scale)},this.text=function(t,e,i,n){var r=0,s=this.ctx,a=0,o=3*e.scale,h=5*e.scale,c=1*e.scale,l=this.textWidth(t,e),u=0;for("number"!=typeof t&&"0"!==t[0]||(t+="",a=43),i=i||(this.c.width-l)/2,r=0;r<t.length;r+=1)u=(t.charCodeAt(r)-65+a)*(o+c),u>-1&&s.drawImage(e,u,0,o,h,~~i,~~n,o,h),i+=o+c}}Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=i},function(t,e){"use strict";function i(t,e){var i=this,n=window.addEventListener;this.c=t,this.g=e,this.click=0,this.keys={l:0,r:0},this.resetKeys=function(){i.keys={l:0,r:0}},n("keydown",function(t){switch(t.keyCode){case 39:i.keys.r=1,i.click=!0;break;case 37:i.keys.l=1,i.click=!0}}),n("touchstart",function(t){t.preventDefault(),i.click=!0,i.trackTouch(t.touches)}),n("touchmove",function(t){t.preventDefault()}),n("touchend",function(t){t.preventDefault(),i.trackTouch(t.touches),i.click=!1}),this.trackTouch=function(t){var e=i.c,n=e.offsetLeft,r=parseInt(e.style.width,10)/e.width;~~(t[0].pageX-n)/r<e.width/2?i.keys.l=1:i.keys.r=1}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={timeStamp:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},rnd:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},rndArray:function(t){return t[~~(Math.random()*t.length)]},mkCanvas:function(t,e){var i=document.createElement("canvas"),n=i.getContext("2d");return i.width=t,i.height=e,n.mozImageSmoothingEnabled=!1,n.msImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1,i},mkFont:function(t,e,i){var n=t.draw.color(t.imgs["font_"+e],t.options.pal[i],!0);return n.scale=e,n},tween:function(t,e,i,n){return i*t/n+e}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(8),s=n(r),a=i(9),o=n(a);e.default={title:"BUNNY LOST",pal:[[0,0,0],[73,60,43],[164,100,34],[190,38,51],[224,111,139],[235,137,49],[255,255,255],[247,226,107],[47,72,78],[68,137,26],[27,38,50],[0,87,132],[49,162,242],[178,220,239]],i:s.default,sfx:o.default}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={bat:"R0lGODlhEAAIAKECAAAAAL4mMzGi8jGi8iH5BAEKAAIALAAAAAAQAAgAAAIdlGBolysBQHBQuhgvdkfphYVKCIpldnqJunLdUgAAOw==",boom:"R0lGODlhDAAMAIABAP///zGi8iH5BAEKAAEALAAAAAAMAAwAAAIWjAMJd+pr3otSoYqz3uli+oET40FGAQA7",carrot:"R0lGODlhCAAIAKEDAKRkIkSJGuuJMTGi8iH5BAEKAAMALAAAAAAIAAgAAAIS3IJha8oD0gLCGVodXmEz8RgFADs=",flower:"R0lGODlhCAAIAIABAABXhDGi8iH5BAEKAAEALAAAAAAIAAgAAAIJjI+ZoMyrolQFADs=",font:"R0lGODlhjwAFAIABAAAAAP///yH5BAEKAAEALAAAAACPAAUAAAJzDGKHcLzOFDRJ0UbXzdJ2lFQbRo5ipJ1TA7XsW2KanNWyZXpuzuNSz5txQDZTChSrsI6kXfOHDNmcl9+LKXxiU7fHBwV2zFxJzwZbGiazq+kyqua2h0I6vEhLh977Dm1fBaW1BvUwYmYY16UiuDN29VhRAAA7",hog:"R0lGODlhFAAJAKEDAL4mM+Bvi////zGi8iH5BAEKAAMALAAAAAAUAAkAAAIjnI8Ykbc91kuSGTFA0BNrbglVNYjjc6ZpdDqtIjWkQtcWhBQAOw==",hornet:"R0lGODlhBgAHAMIEAEk8K74mM7Lc7/fiazGi8jGi8jGi8jGi8iH5BAEKAAQALAAAAAAGAAcAAAMSSAEQ9GM8IpigIopbwYXSBEwJADs=",lilly:"R0lGODlhCAAIAMIBAESJGjGi8qPOJ7Lc7zGi8jGi8jGi8jGi8iH5BAEKAAQALAAAAAAIAAgAAAMUGLoMDus9JYEYod4s97DCpgwkFiQAOw==",mushroom:"R0lGODlhCAAIAKEDAL4mM+Bvi////zGi8iH5BAEKAAMALAAAAAAIAAgAAAISnI8TkRuAgDtOsmEXPEKk3hkFADs=",ouch:"R0lGODlhCAAIAIABAL4mMzGi8iH5BAEKAAEALAAAAAAIAAgAAAIMTIBgl8gNo5wvrWYKADs=",p1:"R0lGODlhFQAJAMIEAEk8K+Bvi7Lc7////zGi8jGi8jGi8jGi8iH5BAEKAAQALAAAAAAVAAkAAAMzSLrcK+JFqKi1bGYSH99d9VUQxZUdmgoAS7YAWQ5DGUQ1dBO5cPeCGm0W7NU2ntBH2UgAADs=",rock:"R0lGODlhCAAIAKEDAC9ITp2dnf///zGi8iH5BAEKAAMALAAAAAAIAAgAAAITnI+hcRvCgHtBzmoXGCB304VDAQA7",skull:"R0lGODlhBwAGAKECAL4mM////zGi8jGi8iH5BAEKAAIALAAAAAAHAAYAAAIMVH4GEHv8kJzI2CAKADs=",tile:"R0lGODlhCAAIAIAAADGi8jGi8iH5BAEKAAEALAAAAAAIAAgAAAIHjI+py+1dAAA7",tree:"R0lGODlhCAAUAIABAAAAADGi8iH5BAEKAAEALAAAAAAIABQAAAIejGF5msjhGohqPstwRXh6qUGaF4qUSX1bqh6kSyIFADs=",wall:"R0lGODlhCAAIAIABAEk8KzGi8iH5BAEKAAEALAAAAAAIAAgAAAILhB15G+sPo2wopQIAOw==",water:"R0lGODlhCAAIAIAAADGi8jGi8iH5BAEKAAEALAAAAAAIAAgAAAIHhI+py+1dAAA7",water2:"R0lGODlhCAAIAKEAADGi8rLc7zGi8jGi8iH5BAEKAAIALAAAAAAIAAgAAAIJhI+py+0QoowFADs="}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={step:[200,40,2,2,.2,2],coin:[500,0,10,20,.1],fart:[50,50,10,10,1,1],jump:[150,30,15,20,.5],bounce:[260,-60,15,15,.5,2],pew:[920,-80,20,15,.2,0],zap:[500,-200,40,10,.25,0]}},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.Title=function(){function t(e){i(this,t),this.g=e}return n(t,[{key:"init",value:function(){var t=this.g;this.curtain=t.h,this.font=t.H.mkFont(t,5,10),this.font2=t.H.mkFont(t,7,10),this.font3=t.H.mkFont(t,4,6),this.Sfont=t.H.mkFont(t,5,7),this.Sfont2=t.H.mkFont(t,7,7),this.moon={},this.moon.x=50,this.moon.y=-250,this.moon.targetY=40,this.moonDist=0,this.sMoon=t.draw.color(t.imgs.boom,t.options.pal[7],!0)}},{key:"update",value:function(t){var e=this.g,i=!0,n=!1,r=void 0;try{for(var s,a=e.ents[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){s.value.update(t)}}catch(t){n=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}if(e.input.click&&this.moonDist<25&&!e.transition){var o=0;try{o=window.sessionStorage.getItem("plays")||0,o=parseInt(o,10)}catch(t){}var h=o>0?"main":"intro";e.transition=new e.availEnts.fade({g:e,col:0,y:0,targetY:e.h,changeTo:h})}this.moonDist=this.moon.targetY-this.moon.y,this.moon.y=~~e.H.tween(33,this.moon.y,this.moonDist,750)}},{key:"render",value:function(t){var e=this.g;e.draw.clear(e.options.pal[10]);var i=!0,n=!1,r=void 0;try{for(var s,a=this.g.ents[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){s.value.render(t)}}catch(t){n=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}e.draw.img(this.sMoon,50,this.moon.y,19),e.draw.img(e.imgs.boom,50,this.moon.y,18),this.moonDist<25&&(e.draw.ctx.globalAlpha=.5,e.draw.text("BUNNY",this.Sfont,!1,85),e.draw.text("LOST",this.Sfont2,!1,120),e.draw.ctx.globalAlpha=1),e.draw.text("BUNNY",this.font,!1,80),e.draw.text("LOST",this.font2,!1,115),e.draw.rect(0,460,e.w,e.h,e.options.pal[0]),e.draw.img(e.imgs.tree,0,300,10),e.draw.img(e.imgs.tree,100,280,12),e.draw.img(e.imgs.tree,200,320,8),e.draw.img(e.imgs.tree,250,420,8),e.draw.img(e.imgs.tree,270,420,9),e.draw.img(e.imgs.tree,300,420,9),e.draw.img(e.imgs.tree,260,350,13),e.draw.ctx.globalAlpha=.5,e.draw.img(e.imgs.tree,60,400,3),e.draw.img(e.imgs.tree,70,410,8),e.draw.img(e.imgs.tree,120,380,5),e.draw.img(e.imgs.tree,220,380,6),e.draw.img(e.imgs.tree,280,380,4),e.draw.img(e.imgs.tree,300,380,4),e.draw.ctx.globalAlpha=1,e.fader>0&&this.moonDist<25&&e.draw.text(e.mobile?"TAP TO PLAY":"L OR R CURSORS",this.font3,!1,400)}}]),t}()},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.Intro=function(){function t(e){i(this,t),this.g=e}return n(t,[{key:"init",value:function(){var t=this,e=this.g;this.font=e.H.mkFont(e,5,10),this.font2=e.H.mkFont(e,7,10),this.font3=e.H.mkFont(e,4,6),this.skipFont=e.H.mkFont(e,5,7),this.curtain=e.h,this.bunny=e.spawn("bunny",{x:120,y:350}),this.addText("HALP!",50),this.addText("I AM",150),this.addText("LOST",250),this.addText("IN THE",350),this.addText("FOREST",450),this.addText("OF DOOM",550),this.addText("HALP ME",750),this.addText("GET HOME",850),this.addText("PLEASE",1050),this.g.addEvent({time:1150,cb:function(){t.g.transition=new t.g.availEnts.fade({g:t.g,col:0,y:0,targetY:e.h,changeTo:"main"})}}),this.sounds=["step","pew","zap","fart"],window.i=this.i}},{key:"update",value:function(t){this.g.input.keys.r&&this.g.changeState("main"),this.curtain>1&&(this.curtain-=9);var e=!0,i=!1,n=void 0;try{for(var r,s=this.g.ents[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){r.value.update(t)}}catch(t){i=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw n}}}},{key:"render",value:function(t){var e=this.g;e.draw.clear(e.options.pal[10]),e.draw.ctx.globalAlpha=.5,e.draw.img(e.imgs.tree,40,260,8),e.draw.img(e.imgs.tree,290,360,3),e.draw.img(e.imgs.tree,220,340,6),e.draw.ctx.globalAlpha=1,e.draw.rect(0,e.h-60,e.w,60,e.options.pal[9]),e.draw.rect(0,e.h-60,e.w,10,e.options.pal[8]),e.draw.img(e.imgs.boom,50,10,20),e.draw.text("SKIP",this.skipFont,e.w-90,e.h-34);var i=!0,n=!1,r=void 0;try{for(var s,a=this.g.ents[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){s.value.render(t)}}catch(t){n=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}this.curtain&&e.draw.rect(0,0,e.w,this.curtain,e.options.pal[0])}},{key:"addText",value:function(t,e){var i=this;arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.g.addEvent({time:e,cb:function(){var e=i.g.H.rndArray(i.sounds);i.g.sfx.play(e),i.g.spawn("text",{x:100,y:310,scale:5,text:t,col:4}),i.bunny.flip.x=i.bunny.flip.x?0:1}})}}]),t}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Main=void 0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(13);e.Main=function(){function t(e){n(this,t),this.g=e}return r(t,[{key:"init",value:function(){var t=this.g;this.speed=60,this.map=new s.Map(t,{p:this}),this.p1=t.spawn("p1",{x:160,y:320,p:this}),this.font=t.H.mkFont(t,4,6),this.fontB=t.H.mkFont(t,10,3),this.g.draw.clear(t.options.pal[11]),this.tile=0,this.g.score=0,this.curtain=t.h,this.gameOver=0,0===this.g.plays&&this.helpText()}},{key:"update",value:function(t){var e=this.g;this.curtain>1&&(this.curtain-=13),this.map.update(t),Math.random()>.99&&e.spawn(e.score>75?"bat":"hornet",{p:this});var i=!0,n=!1,r=void 0;try{for(var s,a=this.g.ents[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){s.value.update(t)}}catch(t){n=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}if(this.p1.dead){if(0===this.gameOver&&this.g.score>this.g.hiScore&&(this.g.spawn("text",{x:40,y:150,scale:6,text:"NEW HISCORE",col:5,accel:.2,fade:.001}),this.g.hiScore=this.g.score),0===this.gameOver)try{texta_close()}catch(t){}if(this.speed=0,this.gameOver+=1,e.input.click&&this.gameOver>75){e.plays+=1;try{window.sessionStorage.setItem("plays",e.plays)}catch(t){}e.changeState("main")}}else{switch(this.tile=this.map.getTile(this.p1.x,this.p1.y),this.tile){case 1:e.sfx.play("coin"),e.score+=1,this.map.setTile(this.p1.x,this.p1.y,0),e.spawn("carrot",{x:this.p1.x,y:this.p1.y,i:"carrot",scale:3});break;case 6:case 7:case 8:this.p1.isMoving()||(this.p1.kill(),this.g.sfx.play("pew"),e.spawn("boom",{x:this.p1.x,y:this.p1.y,i:"boom",magnitude:32}));break;case 2:break;case 0:}if(e.score>=99)try{e.changeState("win"),texta_win()}catch(t){}}}},{key:"render",value:function(t){var e=this.g;e.draw.clear(e.options.pal[10]),this.map.render();var i=!0,n=!1,r=void 0;try{for(var s,a=this.g.ents[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){s.value.render(t)}}catch(t){n=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}e.draw.rect(0,0,e.w,32,e.options.pal[0]),e.draw.rect(0,32,e.w,4,e.options.pal[0],.3),e.draw.text(e.score,this.font,75,6),e.draw.text("HI ",this.font,e.w-100,6),e.draw.text(e.hiScore,this.font,e.w-50,6),this.p1.dead&&e.draw.rect(0,180,10*this.gameOver,160,e.options.pal[6],.8),10*this.gameOver>e.w&&e.fader>0&&(e.draw.text("GAME",this.fontB,!1,200),e.draw.text("OVER",this.fontB,!1,260)),this.curtain&&e.draw.rect(0,0,e.w,this.curtain,e.options.pal[0])}},{key:"helpText",value:function(){this.g.mobile?(this.addText("TAP HERE",50,10),this.addText("TO JUMP LEFT",150,10),this.addText("TAP HERE",250,190),this.addText("TO JUMP RIGHT",350,110)):(this.addText("LEFT CURSOR",50,10),this.addText("JUMPS LEFT",150,10),this.addText("RIGHT CURSOR",250,120),this.addText("JUMPS RIGHT",350,130))}},{key:"addText",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.g.addEvent({time:e,cb:function(){i.g.spawn("text",{x:n,y:310,scale:4,text:t,col:6})}})}}]),t}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Map=void 0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(6),a=function(t){return t&&t.__esModule?t:{default:t}}(s),o=i(14),h=(e.Map=function(){function t(e,i){n(this,t),this.g=e,this.p=i.p,this.tileSize=8,this.scale=4,this.tileDim=this.tileSize*this.scale,this.tileX=this.g.w/this.tileDim,this.tileY=this.g.h/this.tileDim,this.w=e.w/(this.tileSize*this.scale),this.vx=0,this.vy=1,this.cx=0,this.cy=0,this.tick=0,this.waves=0;var r=e.draw.resize(e.imgs.water2,this.scale),s=e.draw.flip(r,1,1);for(this.tileSet=[e.draw.resize(e.imgs.tile,this.scale),e.draw.resize(e.imgs.carrot,this.scale-1),e.draw.resize(e.imgs.rock,this.scale),e.draw.resize(e.imgs.flower,this.scale),e.draw.resize(e.imgs.wall,this.scale),e.draw.flip(e.draw.resize(e.imgs.wall,this.scale),!0,!1),e.draw.resize(e.imgs.water,this.scale),r,s,e.draw.resize(e.imgs.lilly,this.scale),e.draw.resize(e.imgs.mushroom,this.scale)],this.data=[],this.block=this.makeBlock();this.data.length<=this.tileY/2;)this.data.push(this.newRow());for(;this.data.length<=this.tileY+6;)this.data.unshift(this.newRow())}return r(t,[{key:"newRow",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[4],i=this.g.w/(this.tileSize*this.scale)-2,n=0;n<i;n++)e.push(t?0:Math.random()>.95?this.randomBlock():0);return e.push(5),e}},{key:"nextRow",value:function(){this.block.length||(this.block=this.makeBlock());var t=this.block.pop();return 0===t[0]&&this.g.spawn("hog",{p:this.p}),t}},{key:"randomBlock",value:function(){return a.default.rnd(1,3)}},{key:"update",value:function(t){this.cy+=~~(this.p.speed*t),this.tick+=1,this.tick>1e3&&(this.tick=0),this.waves=Math.floor(this.tick/40)%2?0:1,this.cy>this.tileDim&&(this.data.shift(),this.data.push(this.nextRow()),this.cy-=this.tileDim)}},{key:"render",value:function(){for(var t=this,e=0,i=this.cy,n=this.g,r=a.default.mkCanvas(n.w,n.h),s=r.getContext("2d"),o=this.g.h/(this.tileSize*this.scale),h=(this.cy,this.tileSet),c=(this.p,this.tileDim),l=0;l<o;l+=1){var u=this.data[this.data.length-l-1];e=0,u.forEach(function(r){if(r)if(s.drawImage(h[r],e,i),1!==t.waves||8!==r&&7!==r){if(6===r&&Math.random()>.95){var a=n.H.rnd(c/4,c-c/4);s.fillStyle="#fff",s.fillRect(e+a,i+a,8,4)}}else;e+=c}),i+=c}n.draw.ctx.drawImage(r,0,0)}},{key:"getTile",value:function(t,e){var i=h(t/this.tileDim),n=h(h(e/this.tileDim)-h(this.cy/this.tileDim));return this.data[this.data.length-n-1][i]}},{key:"setTile",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=h(t/this.tileDim),r=h(h(e/this.tileDim)-h(this.cy/this.tileDim));this.data[this.data.length-r-1][n]=i}},{key:"exactFit",value:function(t,e){var i=t/this.tileDim,n=h(e/this.tileDim),r=this.cy===this.tileDim?0:this.cy;return i*this.tileDim===t&&n*this.tileDim+r===e}},{key:"makeBlock",value:function(){var t=this.g.H.rndArray(Object.keys(o.Segments));return o.Segments[t].build()}}]),t}(),Math.floor)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StartSeg=e.Segments=void 0;var n=i(6),r=function(t){return t&&t.__esModule?t:{default:t}}(n),s=i(15),a=i(16),o=(e.Segments={water:{build:function(){var t=r.default.rndArray(s.Bridges);return t.unshift(o()),t.push(o()),t}},rocks:{build:function(){for(var t=[],e=r.default.rnd(3,8);e--;)t.push(o());return t}},hogs:{build:function(){var t=[],e=r.default.rnd(1,3);for(t.push(o());e--;)t.push([0,0,0,0,0,0,0,0,0,0]),t.push([0,0,0,0,0,0,0,0,0,0]),t.push([0,0,0,0,0,0,0,0,0,0]);return t.push(o()),t.push(o()),t}},carrots:{build:function(){var t=r.default.rndArray(a.Carrots);return t.unshift(o()),t.push(o()),t}}},e.StartSeg={build:function(){for(var t=[],e=10;e--;)t.push(o());return t}},function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[4],i=0;i<8;i++)e.push(t?0:Math.random()>.95?h():0);return e.push(5),e}),h=function(){return r.default.rnd(1,3)}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Bridges=[[[8,8,8,8,8,9,9,8,8,8],[6,6,6,6,9,9,9,9,6,6],[7,7,7,9,9,9,9,9,7,7]],[[8,8,8,8,9,9,8,8,8,8],[7,7,7,7,9,9,7,7,7,7]],[[8,8,8,9,8,8,9,9,8,8],[6,6,9,6,9,6,9,9,6,6],[7,9,7,7,9,9,9,7,9,7]],[[8,8,8,8,9,9,8,8,8,8],[6,6,6,6,9,9,6,6,6,6],[6,6,6,6,9,9,6,6,6,6],[6,6,6,6,9,9,6,6,6,6],[9,9,7,9,9,9,9,7,9,9]]]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Carrots=[[[4,0,0,0,0,0,0,0,0,5],[4,1,0,0,0,0,0,0,1,5],[4,0,1,0,0,0,0,1,0,5],[4,0,0,1,0,0,1,0,0,5],[4,0,0,0,1,1,0,0,0,5],[4,0,0,0,1,1,0,0,0,5],[4,0,0,1,0,0,1,0,0,5],[4,0,1,0,0,0,0,1,0,5],[4,1,0,0,0,0,0,0,1,5]],[[4,0,0,0,0,0,0,0,1,5],[4,0,0,0,0,0,0,1,0,5],[4,0,0,0,0,0,1,0,0,5],[4,0,0,0,0,1,0,0,0,5],[4,0,0,0,1,0,0,0,0,5],[4,0,0,1,0,0,0,0,0,5],[4,0,1,0,0,0,0,0,0,5],[4,1,0,0,0,0,0,0,0,5]],[[4,0,0,0,0,0,0,0,0,5],[4,1,0,0,0,0,0,0,0,5],[4,0,1,0,0,0,0,0,0,5],[4,0,0,1,0,0,0,0,0,5],[4,0,0,0,1,0,0,0,0,5],[4,0,0,0,0,1,0,0,0,5],[4,0,0,0,0,0,1,0,0,5],[4,0,0,0,0,0,0,1,0,5],[4,0,0,0,0,0,0,0,1,5]],[[4,0,0,0,1,0,0,0,0,5],[4,0,0,0,0,1,0,0,0,5],[4,0,0,0,1,0,0,0,0,5],[4,0,0,0,0,1,0,0,0,5],[4,0,0,0,1,0,0,0,0,5],[4,0,0,0,0,1,0,0,0,5]]]},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.Win=function(){function t(e){i(this,t),this.g=e}return n(t,[{key:"init",value:function(){var t=this,e=this.g;this.curtain=e.h,this.font=e.H.mkFont(e,7,5),this.dings=0,this.tick=0,this.sun={},this.sun.x=50,this.sun.y=2*e.h,this.sun.targetY=10,this.sunImg=e.draw.color(e.imgs.boom,e.options.pal[7],!0),this.flower=e.draw.color(e.imgs.flower,e.options.pal[3],!0),this.flower2=e.draw.color(e.imgs.flower,e.options.pal[6],!0),this.g.addEvent({time:1e3,cb:function(){t.g.changeState("title")}})}},{key:"update",value:function(t){var e=this.g,i=!0,n=!1,r=void 0;try{for(var s,a=e.ents[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){s.value.update(t)}}catch(t){n=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}this.tick+=1,this.tick%30==0&&this.dings<3&&(this.dings+=1,e.sfx.play(3===this.dings?"fart":"coin"));var o=this.sun.targetY-this.sun.y;this.sun.y=~~e.H.tween(33,this.sun.y,o,350)}},{key:"render",value:function(t){var e=this.g;e.draw.clear(e.options.pal[12]);var i=!0,n=!1,r=void 0;try{for(var s,a=this.g.ents[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){s.value.render(t)}}catch(t){n=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}e.draw.img(this.sunImg,50,this.sun.y,20),e.draw.text("YOU",this.font,!1,80),e.draw.text("WIN",this.font,!1,120),e.draw.rect(0,436,e.w,e.h,e.options.pal[8]),e.draw.rect(0,440,e.w,e.h,e.options.pal[9]),e.draw.img(this.flower,50,450,5),e.draw.img(this.flower2,150,440,4),e.draw.img(this.flower,250,430,6),e.draw.ctx.globalAlpha=.5,e.draw.ctx.globalAlpha=1}}]),t}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.P1=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},h=i(19);e.P1=function(t){function e(t,i){n(this,e),i.i="p1",i.frames=3,i.scale=4;var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.gap=s.p.map.tileDim,s.speed=4,s.defaultSpeed=4,s.collidesWith="baddies",s.anims={blink:{frames:[1,2,1,1,1,1],rate:.2},run:{frames:[3],rate:.02},push:{frames:[4],rate:.02}},s.group="p1",s.changeAnim("blink"),s.targetX=s.x,s.targetY=s.y,s.offsetY=-6,s.combo=0,s}return s(e,t),a(e,[{key:"update",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this.isMoving()?(this.targetY+=t*this.p.speed,this.x<this.targetX&&(this.x+=this.speed),this.x>this.targetX&&(this.x-=this.speed),this.y<this.targetY&&(this.y+=this.speed),this.y>this.targetY&&(this.y-=this.speed)):(this.speed=this.defaultSpeed,this.y+=t*this.p.speed,this.targetY=this.y,"blink"!==this.anim.name&&this.changeAnim("blink"),this.pollInput()),this.y>this.g.h&&(this.kill(),this.g.sfx.play("fart")),this.hurt>0&&(this.hurt-=1)}},{key:"isMoving",value:function(){return this.x!==this.targetX||this.targetY!==this.y}},{key:"pollInput",value:function(){var t=this.g.input.keys,e=this.p.map.tileDim,i=this.x,n=this.y;if(t.r?i=this.x+e:t.l&&(i=this.x-e),n=i!=this.x&&this.y>2*e?this.y-e:n,i!==this.x||n!==this.y){var r=this.p.map.getTile(i,n);1===r?this.combo+=1:this.combo=0,2!==r&&4!==r&&5!==r?(this.g.score+=1,this.changeAnim("run"),this.g.sfx.play("step"),this.flip.x=this.x!==i?i<this.x:this.flip.x,this.targetX=i,this.targetY=n):(this.g.sfx.play("bounce"),this.flip.x=!this.flip.x,this.g.score-=1,this.hurt=10,n=this.y+e,i=i>this.x?this.x-e:this.x+e,this.speed=8,this.targetX=i,this.targetY=n)}}},{key:"doDamage",value:function(t){this.g.sfx.play("pew"),this.kill(),this.g.spawn("boom",{x:this.x,y:this.y,col:3,magnitude:32})}}]),e}(h.Sprite)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.Sprite=function(){function t(e,n){i(this,t),this.g=e,this.o=n,this.id=Date.now()+"-"+e.ents.length,this.dead=!1,this.remove=!1,this.offsetY=0,this.name=n.i;for(var r in n)this[r]=n[r];this.lastPos={x:this.x,y:this.y},this.flip={x:0,y:0},this.scale=n.scale||1,this.frame=n.frame||1,this.frames=n.frames||1,this.frameRate=n.frameRate||80,this.frameNext=n.frameNext||0,this.mkImg(n.i),this.hurt=!1,this.anims={idle:{frames:[1],rate:80}},this.changeAnim("idle")}return n(t,[{key:"update",value:function(t){this.collidesWith&&this.hitGroup(this.collidesWith),this.updateAnim(t)}},{key:"render",value:function(){var t=this.g,e=this.hurt?this.iHurt:this.i,i=this.frame;e?(this.flip.y&&(e=t.draw.flip(e,0,1)),this.flip.x&&(e=t.draw.flip(e,1,0),i=this.frames-this.frame+1),t.draw.ctx.drawImage(e,i*this.w-this.w,0,this.w,this.h,~~this.x,~~this.y+this.offsetY,this.w,this.h)):this.g.draw.rect(~~this.x,~~this.y,this.w,this.h,this.col)}},{key:"updateAnim",value:function(t){this.frameNext<0&&(this.frameNext=this.anim.rate,this.anim.counter+=1,
this.anim.counter>=this.anim.frames.length&&(this.anim.next?this.changeAnim(this.anim.next):this.anim.counter=0),this.frame=this.anim.frames[this.anim.counter]),this.frameNext-=this.g.dt}},{key:"hitGroup",value:function(t){for(var e=this.g,i=e.ents.length;i--;)e.ents[i]&&e.ents[i].group===t&&e.ents[i].id!==this.id&&this.hit(e.ents[i])&&e.ents[i].dead===!1&&(this.doDamage(e.ents[i]),e.ents[i].receiveDamage(this))}},{key:"hit",value:function(t){var e=this,i=e.h/2;"hog"===t.name||this.h;return this.h,!(t.y+t.h<e.y+i||t.y>e.y+i/2||t.x+t.w<e.x||t.x>e.x+e.w)}},{key:"receiveDamage",value:function(t){}},{key:"doDamage",value:function(t){}},{key:"kill",value:function(){this.dead=this.remove=!0}},{key:"mkImg",value:function(t){if(this.i){var e=this.g;this.i=e.draw.resize(e.imgs[t],this.scale),this.w=this.i.width/this.frames,this.h=this.i.height,this.iHurt=e.draw.color(this.i,[190,38,51])}}},{key:"changeAnim",value:function(t){this.anim&&this.anim.name&&this.anim.name===t||(this.anim=this.anims[t],this.anim.name=t,this.anim.counter=0,this.frame=this.anim.frames[0],this.frameNext=this.anim.rate)}}]),t}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Carrot=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(19);e.Carrot=function(t){function e(t,i){n(this,e);var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.group="carrot",s.speed=200,s}return s(e,t),a(e,[{key:"update",value:function(t){this.x-=this.speed*t,this.y-=this.speed*t*2,this.y<0&&this.remove}}]),e}(o.Sprite)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Hog=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},h=i(19);e.Hog=function(t){function e(t,i){n(this,e),i.i="hog",i.frames=2,i.scale=3.5;var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.reset(),s.group="baddies",s.anims={run:{frames:[1,2],rate:.045}},s.changeAnim("run"),s}return s(e,t),a(e,[{key:"reset",value:function(){this.y=0,Math.random()>.5?(this.x=0,this.dir=1,this.flip.x=1):(this.x=this.g.w,this.dir=-1,this.flip.x=0),this.speed=this.g.H.rnd(100,160)}},{key:"update",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this.x>this.g.w&&(this.dir=-1,this.flip.x=0),this.x<-this.w&&(this.dir=1,this.flip.x=1),this.x+=this.dir*t*this.speed,this.y+=t*this.p.speed}}]),e}(h.Sprite)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Hornet=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},h=i(19);e.Hornet=function(t){function e(t,i){n(this,e),i.x=t.H.rnd(1,8)*i.p.map.tileDim,i.y=t.h+20,i.frames=1,i.scale=4,i.i="hornet";var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.speed=220,s.group="baddies",s.shadow=t.draw.color(s.i,t.options.pal[0]),s}return s(e,t),a(e,[{key:"update",value:function(t){this.y-=this.speed*t,this.y<-this.h&&(this.remove=!0)}},{key:"render",value:function(){var t=this.g;t.draw.ctx.globalAlpha=.3,t.draw.img(this.shadow,this.x+3,this.y+this.w/2),t.draw.ctx.globalAlpha=1,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this)}}]),e}(h.Sprite)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Bat=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(n)},h=i(19);e.Bat=function(t){function e(t,i){n(this,e),i.frames=2,i.scale=4,i.x=t.H.rnd(1,8)*i.p.map.tileDim,i.y=-t.h,i.i="bat";var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.speed=220,s.group="baddies",s.shadow=t.draw.color(s.i,t.options.pal[0]),s.anims={fly:{frames:[1,2],rate:.01}},s.changeAnim("fly"),s.range=t.H.rnd(1,3)/1e3,s}return s(e,t),a(e,[{key:"update",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this.y+=this.speed*t,this.x+=Math.sin((new Date).getTime()*this.range)}},{key:"render",value:function(){var t=this.g;t.draw.ctx.globalAlpha=.2,t.draw.ctx.drawImage(this.shadow,this.frame*this.w-this.w,0,this.w,this.h,3+~~this.x,~~this.y+this.h/2,this.w,this.h),t.draw.ctx.globalAlpha=1,o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this)}}]),e}(h.Sprite)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.Text=function(){function t(e,n){i(this,t),n.group="text",n.vy=n.vy||-10,n.vx=n.vx||0,n.w=10,n.w=10,n.o=1,n.alpha=1,n.scale=n.scale||4,n.col=n.col||6,n.accel=n.accel||.5,n.fade=n.fade||.01;for(var r in n)this[r]=n[r];this.g=e,this.p=e.H.mkFont(e,n.scale,n.col)}return n(t,[{key:"update",value:function(t){(this.y<0||this.alpha<.1)&&(this.remove=!0),this.vy-=this.accel,this.alpha-=this.fade,this.vx&&(this.x+=this.vx*t),this.y+=this.vy*t}},{key:"render",value:function(){var t=this.g.draw;this.text?(t.ctx.globalAlpha=this.alpha,t.text(this.text,this.p,this.x,this.y),t.ctx.globalAlpha=1):this.o&&t.ctx.drawImage(this.i,this.x,this.y)}}]),t}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Boom=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(19);e.Boom=function(t){function e(t,i){n(this,e),i.col=i.col||6,i.i=i.i||"ouch";var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.startX=i.x,s.startY=i.y,s.group="na",s.magnitude=i.magnitude||64,s.factor=4,s}return s(e,t),a(e,[{key:"update",value:function(t){this.g;this.scale+=this.factor,this.scale>this.magnitude&&this.factor>0&&(this.factor*=-1),this.scale<=1&&(this.remove=!0),this.mkImg(this.o.i)}},{key:"render",value:function(){var t=this.startX-this.w/2,e=this.y-this.h/2,i=this.g;this.opacity<1&&(i.draw.ctx.globalAlpha=this.opacity),i.draw.ctx.drawImage(this.i,t,e),this.opacity<1&&(i.draw.ctx.globalAlpha=1)}}]),e}(o.Sprite)},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Bunny=void 0;var a=i(19);e.Bunny=function(t){function e(t,i){n(this,e),i.i="p1",i.frames=3,i.scale=8;var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.anims={blink:{frames:[1,2,1,1,1,1],rate:.2}},s.changeAnim("blink"),s}return s(e,t),e}(a.Sprite)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.Fade=function(){function t(e){i(this,t);var n=e.g;this.g=e.g,this.col=n.options.pal[e.col],this.y=e.y,this.startY=e.y,this.targetY=e.targetY,this.done=!1,this.changeTo=e.changeTo||!1}return n(t,[{key:"update",value:function(){var t=this.g,e=this.targetY-this.y;this.y=~~t.H.tween(33,this.y,e,250),(this.y>this.targetY-10||this.y===this.targetY)&&(this.done=!0)}},{key:"render",value:function(){var t=this.g;t.draw.rect(0,this.startY,t.w,this.y,this.col)}}]),t}()},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var i=[],n=!0,r=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){r=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(r)throw s}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function t(t){a=t}function e(t){h||s(a[t])}function n(){return 1}function r(t,e){var i,n=Date.now,r=requestAnimationFrame,s=n(),a=function a(){n()-s<e||(s+=e,t()),i||r(a)};return r(a),{clear:function(){i=1}}}function s(t){function e(){g.frequency.value=a+o*m,y.gain.value=(1-m/u)*f*n(),(m+=1)>u&&(A.clear(),g.stop())}var s=i(t,6),a=s[0],o=s[1],h=s[2],u=s[3],f=s[4],d=s[5],p=void 0===d?0:d,g=c.createOscillator();p=void 0===p?0:p,g.frequency.value=a,g.type=l[p];var y=c.createGain();y.gain.value=0,g.connect(y),y.connect(c.destination),g.start();var m=0,A=r(e,h)}var a={},o=navigator.userAgent.toLowerCase(),h=/ipad|iphone|ipod/.test(o),c=new(window.AudioContext||window.webkitAudioContext),l=["square","sawtooth","triangle","sine"];return{add:t,play:e}}();e.default=n}]);